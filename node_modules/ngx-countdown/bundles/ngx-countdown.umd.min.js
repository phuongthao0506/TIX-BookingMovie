!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-countdown",["exports","@angular/core","@angular/common"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self)["ngx-countdown"]={},t.ng.core,t.ng.common)}(this,(function(t,n,e){"use strict";var o;(o=t.CountdownStatus||(t.CountdownStatus={}))[o.ing=0]="ing",o[o.pause=1]="pause",o[o.stop=2]="stop",o[o.done=3]="done";var i=function(){function t(t){this.ngZone=t,this.fns=[],this.commands=[],this.ing=!1}return t.prototype.start=function(){var t=this;!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular((function(){t.process()})))},t.prototype.process=function(){for(var t=this;this.commands.length;)this.commands.shift()();var n=+new Date-this.nextTime,e=1+Math.floor(n/100);n=100-n%100,this.nextTime+=100*e;for(var o=0,i=this.fns.length;o<i;o+=2){var s=this.fns[o+1];if(0===s)this.fns[o](e);else{s+=2*e-1;var r=Math.floor(s/20);r>0&&this.fns[o](r),this.fns[o+1]=s%20+1}}this.ing&&setTimeout((function(){return t.process()}),n)},t.prototype.add=function(t,n){var e=this;return this.commands.push((function(){e.fns.push(t),e.fns.push(1e3===n?1:0),e.ing=!0})),this},t.prototype.remove=function(t){var n=this;return this.commands.push((function(){var e=n.fns.indexOf(t);-1!==e&&n.fns.splice(e,2),n.ing=n.fns.length>0})),this},t}();i.decorators=[{type:n.Injectable}],i.ctorParameters=function(){return[{type:n.NgZone}]};var s=function(t){var n=this;this.locale=t,this.demand=!1,this.leftTime=0,this.format="HH:mm:ss",this.timezone="+0000",this.formatDate=function(t){var o=t.date,i=t.formatStr,s=t.timezone;return e.formatDate(new Date(o),i,n.locale,s||n.timezone||"+0000")}};s.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new s(n.ɵɵinject(n.LOCALE_ID))},token:s,providedIn:"root"}),s.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],s.ctorParameters=function(){return[{type:String,decorators:[{type:n.Inject,args:[n.LOCALE_ID]}]}]};var r=function(){function e(e,o,i,s,r){this.locale=e,this.timer=o,this.defCog=i,this.cdr=s,this.ngZone=r,this.frequency=1e3,this._notify={},this.status=t.CountdownStatus.ing,this.isDestroy=!1,this.i={},this.left=0,this.event=new n.EventEmitter}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},set:function(t){null!=t.notify&&!Array.isArray(t.notify)&&t.notify>0&&(t.notify=[t.notify]),this._config=t},enumerable:!1,configurable:!0}),e.prototype.begin=function(){this.status=t.CountdownStatus.ing,this.callEvent("start")},e.prototype.restart=function(){this.status!==t.CountdownStatus.stop&&this.destroy(),this.init(),this.callEvent("restart")},e.prototype.stop=function(){this.status!==t.CountdownStatus.stop&&(this.status=t.CountdownStatus.stop,this.destroy(),this.callEvent("stop"))},e.prototype.pause=function(){this.status!==t.CountdownStatus.stop&&this.status!==t.CountdownStatus.pause&&(this.status=t.CountdownStatus.pause,this.callEvent("pause"))},e.prototype.resume=function(){this.status!==t.CountdownStatus.stop&&this.status===t.CountdownStatus.pause&&(this.status=t.CountdownStatus.ing,this.callEvent("resume"))},e.prototype.callEvent=function(t){this.event.emit({action:t,left:this.left,status:this.status,text:this.i.text})},e.prototype.init=function(){var n=this,e=this.locale,o=this.defCog,i=this.config=Object.assign(Object.assign(Object.assign({},new s(e)),o),this.config),r=this.frequency=~i.format.indexOf("S")?100:1e3;this.status=i.demand?t.CountdownStatus.pause:t.CountdownStatus.ing,this.getLeft();var a=this.reflow;this.reflow=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=!1),a.apply(n,[t,e])},Array.isArray(i.notify)&&i.notify.forEach((function(t){if(t<1)throw new Error("The notify config must be a positive integer.");t*=1e3,t-=t%r,n._notify[t]=!0})),this.timer.add(this.reflow,r).start(),this.reflow(0,!0)},e.prototype.destroy=function(){return this.timer.remove(this.reflow),this},e.prototype.reflow=function(n,e){var o=this;if(void 0===n&&(n=0),void 0===e&&(e=!1),!this.isDestroy){var i=this,s=i.status,r=i.config,a=i._notify;if(e||s===t.CountdownStatus.ing){var u=this.left=this.left-this.frequency*n;u<1&&(u=0),this.i={value:u,text:r.formatDate({date:u,formatStr:r.format,timezone:r.timezone})},"function"==typeof r.prettyText&&(this.i.text=r.prettyText(this.i.text)),this.cdr.detectChanges(),(0===r.notify||a[u])&&this.ngZone.run((function(){o.callEvent("notify")})),0===u&&this.ngZone.run((function(){o.status=t.CountdownStatus.done,o.destroy(),o.callEvent("done")}))}}},e.prototype.getLeft=function(){var t=this.config,n=this.frequency,e=1e3*t.leftTime,o=t.stopTime;!e&&o&&(e=o-(new Date).getTime()),this.left=e-e%n},e.prototype.ngOnInit=function(){this.init(),this.config.demand||this.begin()},e.prototype.ngOnDestroy=function(){this.isDestroy=!0,this.destroy()},e.prototype.ngOnChanges=function(t){t.config.firstChange||this.restart()},e}();r.decorators=[{type:n.Component,args:[{selector:"countdown",template:'\n    <ng-container *ngIf="!render">\n      <span [innerHTML]="i.text"></span>\n    </ng-container>\n    <ng-container *ngTemplateOutlet="render; context: { $implicit: i }"></ng-container>\n  ',host:{"[class.count-down]":"true"},encapsulation:n.ViewEncapsulation.None,changeDetection:n.ChangeDetectionStrategy.OnPush}]}],r.ctorParameters=function(){return[{type:String,decorators:[{type:n.Inject,args:[n.LOCALE_ID]}]},{type:i},{type:s},{type:n.ChangeDetectorRef},{type:n.NgZone}]},r.propDecorators={config:[{type:n.Input}],render:[{type:n.Input}],event:[{type:n.Output}]};var a=function(){};a.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule],providers:[i],declarations:[r],exports:[r]}]}],t.CountdownComponent=r,t.CountdownGlobalConfig=s,t.CountdownModule=a,t.CountdownTimer=i,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-countdown.umd.min.js.map