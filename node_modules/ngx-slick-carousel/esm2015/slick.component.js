/**
 * @fileoverview added by tsickle
 * Generated from: slick.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { isPlatformBrowser, isPlatformServer } from '@angular/common';
import { Component, Directive, ElementRef, EventEmitter, forwardRef, Host, Inject, Input, NgZone, Output, PLATFORM_ID } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
/**
 * Slick component
 */
import * as ɵngcc0 from '@angular/core';

const _c0 = ["*"];
export class SlickCarouselComponent {
    /**
     * Constructor
     * @param {?} el
     * @param {?} zone
     * @param {?} platformId
     */
    constructor(el, zone, platformId) {
        this.el = el;
        this.zone = zone;
        this.platformId = platformId;
        this.afterChange = new EventEmitter();
        this.beforeChange = new EventEmitter();
        this.breakpoint = new EventEmitter();
        this.destroy = new EventEmitter();
        this.init = new EventEmitter();
        // access from parent component can be a problem with change detection timing. Please use afterChange output
        this.currentIndex = 0;
        this.slides = [];
        this.initialized = false;
        this._removedSlides = [];
        this._addedSlides = [];
    }
    /**
     * On component destroy
     * @return {?}
     */
    ngOnDestroy() {
        this.unslick();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.ngAfterViewChecked();
    }
    /**
     * On component view checked
     * @return {?}
     */
    ngAfterViewChecked() {
        if (isPlatformServer(this.platformId)) {
            return;
        }
        if (this._addedSlides.length > 0 || this._removedSlides.length > 0) {
            /** @type {?} */
            const nextSlidesLength = this.slides.length - this._removedSlides.length + this._addedSlides.length;
            if (!this.initialized) {
                if (nextSlidesLength > 0) {
                    this.initSlick();
                }
                // if nextSlidesLength is zere, do nothing
            }
            else if (nextSlidesLength === 0) { // unslick case
                this.unslick();
            }
            else {
                this._addedSlides.forEach((/**
                 * @param {?} slickItem
                 * @return {?}
                 */
                slickItem => {
                    this.slides.push(slickItem);
                    this.zone.runOutsideAngular((/**
                     * @return {?}
                     */
                    () => {
                        this.$instance.slick('slickAdd', slickItem.el.nativeElement);
                    }));
                }));
                this._addedSlides = [];
                this._removedSlides.forEach((/**
                 * @param {?} slickItem
                 * @return {?}
                 */
                slickItem => {
                    /** @type {?} */
                    const idx = this.slides.indexOf(slickItem);
                    this.slides = this.slides.filter((/**
                     * @param {?} s
                     * @return {?}
                     */
                    s => s !== slickItem));
                    this.zone.runOutsideAngular((/**
                     * @return {?}
                     */
                    () => {
                        this.$instance.slick('slickRemove', idx);
                    }));
                }));
                this._removedSlides = [];
            }
        }
    }
    /**
     * init slick
     * @return {?}
     */
    initSlick() {
        this.slides = this._addedSlides;
        this._addedSlides = [];
        this._removedSlides = [];
        this.zone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.$instance = jQuery(this.el.nativeElement);
            this.$instance.on('init', (/**
             * @param {?} event
             * @param {?} slick
             * @return {?}
             */
            (event, slick) => {
                this.zone.run((/**
                 * @return {?}
                 */
                () => {
                    this.init.emit({ event, slick });
                }));
            }));
            this.$instance.slick(this.config);
            this.zone.run((/**
             * @return {?}
             */
            () => {
                var _a;
                this.initialized = true;
                this.currentIndex = ((_a = this.config) === null || _a === void 0 ? void 0 : _a.initialSlide) || 0;
            }));
            this.$instance.on('afterChange', (/**
             * @param {?} event
             * @param {?} slick
             * @param {?} currentSlide
             * @return {?}
             */
            (event, slick, currentSlide) => {
                this.zone.run((/**
                 * @return {?}
                 */
                () => {
                    this.afterChange.emit({
                        event,
                        slick,
                        currentSlide,
                        first: currentSlide === 0,
                        last: slick.$slides.length === currentSlide + slick.options.slidesToScroll
                    });
                    this.currentIndex = currentSlide;
                }));
            }));
            this.$instance.on('beforeChange', (/**
             * @param {?} event
             * @param {?} slick
             * @param {?} currentSlide
             * @param {?} nextSlide
             * @return {?}
             */
            (event, slick, currentSlide, nextSlide) => {
                this.zone.run((/**
                 * @return {?}
                 */
                () => {
                    this.beforeChange.emit({ event, slick, currentSlide, nextSlide });
                    this.currentIndex = nextSlide;
                }));
            }));
            this.$instance.on('breakpoint', (/**
             * @param {?} event
             * @param {?} slick
             * @param {?} breakpoint
             * @return {?}
             */
            (event, slick, breakpoint) => {
                this.zone.run((/**
                 * @return {?}
                 */
                () => {
                    this.breakpoint.emit({ event, slick, breakpoint });
                }));
            }));
            this.$instance.on('destroy', (/**
             * @param {?} event
             * @param {?} slick
             * @return {?}
             */
            (event, slick) => {
                this.zone.run((/**
                 * @return {?}
                 */
                () => {
                    this.destroy.emit({ event, slick });
                    this.initialized = false;
                }));
            }));
        }));
    }
    /**
     * @param {?} slickItem
     * @return {?}
     */
    addSlide(slickItem) {
        this._addedSlides.push(slickItem);
    }
    /**
     * @param {?} slickItem
     * @return {?}
     */
    removeSlide(slickItem) {
        this._removedSlides.push(slickItem);
    }
    /**
     * Slick Method
     * @param {?} index
     * @return {?}
     */
    slickGoTo(index) {
        this.zone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.$instance.slick('slickGoTo', index);
        }));
    }
    /**
     * @return {?}
     */
    slickNext() {
        this.zone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.$instance.slick('slickNext');
        }));
    }
    /**
     * @return {?}
     */
    slickPrev() {
        this.zone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.$instance.slick('slickPrev');
        }));
    }
    /**
     * @return {?}
     */
    slickPause() {
        this.zone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.$instance.slick('slickPause');
        }));
    }
    /**
     * @return {?}
     */
    slickPlay() {
        this.zone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.$instance.slick('slickPlay');
        }));
    }
    /**
     * @return {?}
     */
    unslick() {
        if (this.$instance) {
            this.zone.runOutsideAngular((/**
             * @return {?}
             */
            () => {
                this.$instance.slick('unslick');
            }));
            this.$instance = undefined;
        }
        this.initialized = false;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (this.initialized) {
            /** @type {?} */
            const config = changes['config'];
            if (config.previousValue !== config.currentValue && config.currentValue !== undefined) {
                /** @type {?} */
                const refresh = config.currentValue['refresh'];
                /** @type {?} */
                const newOptions = Object.assign({}, config.currentValue);
                delete newOptions['refresh'];
                this.zone.runOutsideAngular((/**
                 * @return {?}
                 */
                () => {
                    this.$instance.slick('slickSetOption', newOptions, refresh);
                }));
            }
        }
    }
}
SlickCarouselComponent.ɵfac = function SlickCarouselComponent_Factory(t) { return new (t || SlickCarouselComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(PLATFORM_ID)); };
SlickCarouselComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SlickCarouselComponent, selectors: [["ngx-slick-carousel"]], inputs: { config: "config" }, outputs: { afterChange: "afterChange", beforeChange: "beforeChange", breakpoint: "breakpoint", destroy: "destroy", init: "init" }, exportAs: ["slick-carousel"], features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(( /**
                 * @return {?}
                 */() => SlickCarouselComponent)),
                multi: true
            }]), ɵngcc0.ɵɵNgOnChangesFeature], ngContentSelectors: _c0, decls: 1, vars: 0, template: function SlickCarouselComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef();
        ɵngcc0.ɵɵprojection(0);
    } }, encapsulation: 2 });
/** @nocollapse */
SlickCarouselComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: NgZone },
    { type: String, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] }
];
SlickCarouselComponent.propDecorators = {
    config: [{ type: Input }],
    afterChange: [{ type: Output }],
    beforeChange: [{ type: Output }],
    breakpoint: [{ type: Output }],
    destroy: [{ type: Output }],
    init: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SlickCarouselComponent, [{
        type: Component,
        args: [{
                selector: 'ngx-slick-carousel',
                exportAs: 'slick-carousel',
                providers: [{
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef(( /**
                         * @return {?}
                         */() => SlickCarouselComponent)),
                        multi: true
                    }],
                template: '<ng-content></ng-content>'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }, { type: String, decorators: [{
                type: Inject,
                args: [PLATFORM_ID]
            }] }]; }, { afterChange: [{
            type: Output
        }], beforeChange: [{
            type: Output
        }], breakpoint: [{
            type: Output
        }], destroy: [{
            type: Output
        }], init: [{
            type: Output
        }], config: [{
            type: Input
        }] }); })();
if (false) {
    /** @type {?} */
    SlickCarouselComponent.prototype.config;
    /** @type {?} */
    SlickCarouselComponent.prototype.afterChange;
    /** @type {?} */
    SlickCarouselComponent.prototype.beforeChange;
    /** @type {?} */
    SlickCarouselComponent.prototype.breakpoint;
    /** @type {?} */
    SlickCarouselComponent.prototype.destroy;
    /** @type {?} */
    SlickCarouselComponent.prototype.init;
    /** @type {?} */
    SlickCarouselComponent.prototype.$instance;
    /**
     * @type {?}
     * @private
     */
    SlickCarouselComponent.prototype.currentIndex;
    /** @type {?} */
    SlickCarouselComponent.prototype.slides;
    /** @type {?} */
    SlickCarouselComponent.prototype.initialized;
    /**
     * @type {?}
     * @private
     */
    SlickCarouselComponent.prototype._removedSlides;
    /**
     * @type {?}
     * @private
     */
    SlickCarouselComponent.prototype._addedSlides;
    /**
     * @type {?}
     * @private
     */
    SlickCarouselComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    SlickCarouselComponent.prototype.zone;
    /**
     * @type {?}
     * @private
     */
    SlickCarouselComponent.prototype.platformId;
}
export class SlickItemDirective {
    /**
     * @param {?} el
     * @param {?} platformId
     * @param {?} carousel
     */
    constructor(el, platformId, carousel) {
        this.el = el;
        this.platformId = platformId;
        this.carousel = carousel;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (isPlatformBrowser(this.platformId)) {
            this.carousel.addSlide(this);
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (isPlatformBrowser(this.platformId)) {
            this.carousel.removeSlide(this);
        }
    }
}
SlickItemDirective.ɵfac = function SlickItemDirective_Factory(t) { return new (t || SlickItemDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(PLATFORM_ID), ɵngcc0.ɵɵdirectiveInject(SlickCarouselComponent, 1)); };
SlickItemDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: SlickItemDirective, selectors: [["", "ngxSlickItem", ""]] });
/** @nocollapse */
SlickItemDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: String, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
    { type: SlickCarouselComponent, decorators: [{ type: Host }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SlickItemDirective, [{
        type: Directive,
        args: [{
                selector: '[ngxSlickItem]'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: String, decorators: [{
                type: Inject,
                args: [PLATFORM_ID]
            }] }, { type: SlickCarouselComponent, decorators: [{
                type: Host
            }] }]; }, null); })();
if (false) {
    /** @type {?} */
    SlickItemDirective.prototype.el;
    /**
     * @type {?}
     * @private
     */
    SlickItemDirective.prototype.platformId;
    /**
     * @type {?}
     * @private
     */
    SlickItemDirective.prototype.carousel;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2xpY2suY29tcG9uZW50LmpzIiwic291cmNlcyI6WyJuZ3gtc2xpY2stY2Fyb3VzZWwvc2xpY2suY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGdCQUFnQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDdEUsT0FBTyxFQUdMLFNBQVMsRUFDVCxTQUFTLEVBQ1QsVUFBVSxFQUNWLFlBQVksRUFDWixVQUFVLEVBQ1YsSUFBSSxFQUNKLE1BQU0sRUFDTixLQUFLLEVBQ0wsTUFBTSxFQUlOLE1BQU0sRUFDTixXQUFXLEVBRVosTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDbkQ7QUFDRztBQUFtQjs7OztBQWV0QixNQUFNLE9BQU8sc0JBQXNCO0FBQUc7QUFBUTtBQUFtQjtBQUFxQjtBQUVqRjtBQUNHO0FBQVEsSUFtQmQsWUFBb0IsRUFBYyxFQUNkLElBQVksRUFDUyxVQUFrQjtBQUM3RCxRQUhzQixPQUFFLEdBQUYsRUFBRSxDQUFZO0FBQUMsUUFDZixTQUFJLEdBQUosSUFBSSxDQUFRO0FBQUMsUUFDUSxlQUFVLEdBQVYsVUFBVSxDQUFRO0FBQUMsUUFyQmhELGdCQUFXLEdBQWtHLElBQUksWUFBWSxFQUFFLENBQUM7QUFDOUksUUFBYyxpQkFBWSxHQUFzRixJQUFJLFlBQVksRUFBRSxDQUFDO0FBQ25JLFFBQWMsZUFBVSxHQUE4RCxJQUFJLFlBQVksRUFBRSxDQUFDO0FBQ3pHLFFBQWMsWUFBTyxHQUE2QyxJQUFJLFlBQVksRUFBRSxDQUFDO0FBQ3JGLFFBQWMsU0FBSSxHQUE2QyxJQUFJLFlBQVksRUFBRSxDQUFDO0FBQ2xGO0FBRzBGLFFBQ2hGLGlCQUFZLEdBQUcsQ0FBQyxDQUFDO0FBQzNCLFFBQ1MsV0FBTSxHQUFVLEVBQUUsQ0FBQztBQUM1QixRQUFTLGdCQUFXLEdBQUcsS0FBSyxDQUFDO0FBQzdCLFFBQVUs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TUFBTSxTQUFDLFdBQVc7QUFBUyxZQUNGLHNCQUFzQix1QkFBL0MsSUFBSTtBQUFNOzs7Ozs7Ozs7OztrQ0FBRTtBQUFDO0FBQWE7QUFBcUIsSUFGaEQsZ0NBQXFCO0FBQUM7QUFDN0I7QUFBaUI7QUFBZ0I7QUFBUSxJQUFsQyx3Q0FBK0M7QUFBQztBQUN2RDtBQUFpQjtBQUFnQjtBQUFRLElBQWxDLHNDQUFnRDtBQUFDO0FBQUUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciwgaXNQbGF0Zm9ybVNlcnZlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICBBZnRlclZpZXdDaGVja2VkLFxuICBBZnRlclZpZXdJbml0LFxuICBDb21wb25lbnQsXG4gIERpcmVjdGl2ZSxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBmb3J3YXJkUmVmLFxuICBIb3N0LFxuICBJbmplY3QsXG4gIElucHV0LFxuICBOZ1pvbmUsXG4gIE9uQ2hhbmdlcyxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgUExBVEZPUk1fSUQsXG4gIFNpbXBsZUNoYW5nZXNcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuZGVjbGFyZSBjb25zdCBqUXVlcnk6IGFueTtcblxuLyoqXG4gKiBTbGljayBjb21wb25lbnRcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LXNsaWNrLWNhcm91c2VsJyxcbiAgZXhwb3J0QXM6ICdzbGljay1jYXJvdXNlbCcsXG4gIHByb3ZpZGVyczogW3tcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBTbGlja0Nhcm91c2VsQ29tcG9uZW50KSxcbiAgICBtdWx0aTogdHJ1ZVxuICB9XSxcbiAgdGVtcGxhdGU6ICc8bmctY29udGVudD48L25nLWNvbnRlbnQ+Jyxcbn0pXG5leHBvcnQgY2xhc3MgU2xpY2tDYXJvdXNlbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkIHtcblxuICAgIEBJbnB1dCgpIGNvbmZpZzogYW55O1xuICAgIEBPdXRwdXQoKSBhZnRlckNoYW5nZTogRXZlbnRFbWl0dGVyPHsgZXZlbnQ6IGFueSwgc2xpY2s6IGFueSwgY3VycmVudFNsaWRlOiBudW1iZXIsIGZpcnN0OiBib29sZWFuLCBsYXN0OiBib29sZWFuIH0+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBiZWZvcmVDaGFuZ2U6IEV2ZW50RW1pdHRlcjx7IGV2ZW50OiBhbnksIHNsaWNrOiBhbnksIGN1cnJlbnRTbGlkZTogbnVtYmVyLCBuZXh0U2xpZGU6IG51bWJlciB9PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgYnJlYWtwb2ludDogRXZlbnRFbWl0dGVyPHsgZXZlbnQ6IGFueSwgc2xpY2s6IGFueSwgYnJlYWtwb2ludDogYW55IH0+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBkZXN0cm95OiBFdmVudEVtaXR0ZXI8eyBldmVudDogYW55LCBzbGljazogYW55IH0+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBpbml0OiBFdmVudEVtaXR0ZXI8eyBldmVudDogYW55LCBzbGljazogYW55IH0+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIHB1YmxpYyAkaW5zdGFuY2U6IGFueTtcblxuICAvLyBhY2Nlc3MgZnJvbSBwYXJlbnQgY29tcG9uZW50IGNhbiBiZSBhIHByb2JsZW0gd2l0aCBjaGFuZ2UgZGV0ZWN0aW9uIHRpbWluZy4gUGxlYXNlIHVzZSBhZnRlckNoYW5nZSBvdXRwdXRcbiAgcHJpdmF0ZSBjdXJyZW50SW5kZXggPSAwO1xuXG4gIHB1YmxpYyBzbGlkZXM6IGFueVtdID0gW107XG4gIHB1YmxpYyBpbml0aWFsaXplZCA9IGZhbHNlO1xuICBwcml2YXRlIF9yZW1vdmVkU2xpZGVzOiBTbGlja0l0ZW1EaXJlY3RpdmVbXSA9IFtdO1xuICBwcml2YXRlIF9hZGRlZFNsaWRlczogU2xpY2tJdGVtRGlyZWN0aXZlW10gPSBbXTtcblxuICAvKipcbiAgICogQ29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsXG4gICAgICAgICAgICAgIHByaXZhdGUgem9uZTogTmdab25lLFxuICAgICAgICAgICAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IHN0cmluZykge1xuICB9XG5cbiAgLyoqXG4gICAqIE9uIGNvbXBvbmVudCBkZXN0cm95XG4gICAqL1xuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLnVuc2xpY2soKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLm5nQWZ0ZXJWaWV3Q2hlY2tlZCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9uIGNvbXBvbmVudCB2aWV3IGNoZWNrZWRcbiAgICovXG4gIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybVNlcnZlcih0aGlzLnBsYXRmb3JtSWQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLl9hZGRlZFNsaWRlcy5sZW5ndGggPiAwIHx8IHRoaXMuX3JlbW92ZWRTbGlkZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgbmV4dFNsaWRlc0xlbmd0aCA9IHRoaXMuc2xpZGVzLmxlbmd0aCAtIHRoaXMuX3JlbW92ZWRTbGlkZXMubGVuZ3RoICsgdGhpcy5fYWRkZWRTbGlkZXMubGVuZ3RoO1xuICAgICAgaWYgKCF0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgIGlmIChuZXh0U2xpZGVzTGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRoaXMuaW5pdFNsaWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgbmV4dFNsaWRlc0xlbmd0aCBpcyB6ZXJlLCBkbyBub3RoaW5nXG4gICAgICB9IGVsc2UgaWYgKG5leHRTbGlkZXNMZW5ndGggPT09IDApIHsgLy8gdW5zbGljayBjYXNlXG4gICAgICAgIHRoaXMudW5zbGljaygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYWRkZWRTbGlkZXMuZm9yRWFjaChzbGlja0l0ZW0gPT4ge1xuICAgICAgICAgIHRoaXMuc2xpZGVzLnB1c2goc2xpY2tJdGVtKTtcbiAgICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy4kaW5zdGFuY2Uuc2xpY2soJ3NsaWNrQWRkJywgc2xpY2tJdGVtLmVsLm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYWRkZWRTbGlkZXMgPSBbXTtcblxuICAgICAgICB0aGlzLl9yZW1vdmVkU2xpZGVzLmZvckVhY2goc2xpY2tJdGVtID0+IHtcbiAgICAgICAgICBjb25zdCBpZHggPSB0aGlzLnNsaWRlcy5pbmRleE9mKHNsaWNrSXRlbSk7XG4gICAgICAgICAgdGhpcy5zbGlkZXMgPSB0aGlzLnNsaWRlcy5maWx0ZXIocyA9PiBzICE9PSBzbGlja0l0ZW0pO1xuICAgICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLiRpbnN0YW5jZS5zbGljaygnc2xpY2tSZW1vdmUnLCBpZHgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcmVtb3ZlZFNsaWRlcyA9IFtdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBpbml0IHNsaWNrXG4gICAqL1xuICBpbml0U2xpY2soKSB7XG4gICAgdGhpcy5zbGlkZXMgPSB0aGlzLl9hZGRlZFNsaWRlcztcbiAgICB0aGlzLl9hZGRlZFNsaWRlcyA9IFtdO1xuICAgIHRoaXMuX3JlbW92ZWRTbGlkZXMgPSBbXTtcbiAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgdGhpcy4kaW5zdGFuY2UgPSBqUXVlcnkodGhpcy5lbC5uYXRpdmVFbGVtZW50KTtcblxuICAgICAgdGhpcy4kaW5zdGFuY2Uub24oJ2luaXQnLCAoZXZlbnQsIHNsaWNrKSA9PiB7XG4gICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMuaW5pdC5lbWl0KHsgZXZlbnQsIHNsaWNrIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLiRpbnN0YW5jZS5zbGljayh0aGlzLmNvbmZpZyk7XG5cbiAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IHRoaXMuY29uZmlnPy5pbml0aWFsU2xpZGUgfHwgMDtcbiAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLiRpbnN0YW5jZS5vbignYWZ0ZXJDaGFuZ2UnLCAoZXZlbnQsIHNsaWNrLCBjdXJyZW50U2xpZGUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnpvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZnRlckNoYW5nZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2ssXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U2xpZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogY3VycmVudFNsaWRlID09PSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdDogc2xpY2suJHNsaWRlcy5sZW5ndGggPT09IGN1cnJlbnRTbGlkZSArIHNsaWNrLm9wdGlvbnMuc2xpZGVzVG9TY3JvbGxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gY3VycmVudFNsaWRlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgIHRoaXMuJGluc3RhbmNlLm9uKCdiZWZvcmVDaGFuZ2UnLCAoZXZlbnQsIHNsaWNrLCBjdXJyZW50U2xpZGUsIG5leHRTbGlkZSkgPT4ge1xuICAgICAgICB0aGlzLnpvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmJlZm9yZUNoYW5nZS5lbWl0KHsgZXZlbnQsIHNsaWNrLCBjdXJyZW50U2xpZGUsIG5leHRTbGlkZSB9KTtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IG5leHRTbGlkZTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy4kaW5zdGFuY2Uub24oJ2JyZWFrcG9pbnQnLCAoZXZlbnQsIHNsaWNrLCBicmVha3BvaW50KSA9PiB7XG4gICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMuYnJlYWtwb2ludC5lbWl0KHsgZXZlbnQsIHNsaWNrLCBicmVha3BvaW50IH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLiRpbnN0YW5jZS5vbignZGVzdHJveScsIChldmVudCwgc2xpY2spID0+IHtcbiAgICAgICAgdGhpcy56b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5kZXN0cm95LmVtaXQoeyBldmVudCwgc2xpY2sgfSk7XG4gICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkU2xpZGUoc2xpY2tJdGVtOiBTbGlja0l0ZW1EaXJlY3RpdmUpIHtcbiAgICB0aGlzLl9hZGRlZFNsaWRlcy5wdXNoKHNsaWNrSXRlbSk7XG4gIH1cblxuICByZW1vdmVTbGlkZShzbGlja0l0ZW06IFNsaWNrSXRlbURpcmVjdGl2ZSkge1xuICAgIHRoaXMuX3JlbW92ZWRTbGlkZXMucHVzaChzbGlja0l0ZW0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNsaWNrIE1ldGhvZFxuICAgKi9cbiAgcHVibGljIHNsaWNrR29UbyhpbmRleDogbnVtYmVyKSB7XG4gICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHRoaXMuJGluc3RhbmNlLnNsaWNrKCdzbGlja0dvVG8nLCBpbmRleCk7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgc2xpY2tOZXh0KCkge1xuICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICB0aGlzLiRpbnN0YW5jZS5zbGljaygnc2xpY2tOZXh0Jyk7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgc2xpY2tQcmV2KCkge1xuICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICB0aGlzLiRpbnN0YW5jZS5zbGljaygnc2xpY2tQcmV2Jyk7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgc2xpY2tQYXVzZSgpIHtcbiAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgdGhpcy4kaW5zdGFuY2Uuc2xpY2soJ3NsaWNrUGF1c2UnKTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBzbGlja1BsYXkoKSB7XG4gICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHRoaXMuJGluc3RhbmNlLnNsaWNrKCdzbGlja1BsYXknKTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyB1bnNsaWNrKCkge1xuICAgIGlmICh0aGlzLiRpbnN0YW5jZSkge1xuICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgdGhpcy4kaW5zdGFuY2Uuc2xpY2soJ3Vuc2xpY2snKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy4kaW5zdGFuY2UgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgY29uc3QgY29uZmlnID0gY2hhbmdlc1snY29uZmlnJ107XG4gICAgICBpZiAoY29uZmlnLnByZXZpb3VzVmFsdWUgIT09IGNvbmZpZy5jdXJyZW50VmFsdWUgJiYgY29uZmlnLmN1cnJlbnRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IHJlZnJlc2ggPSBjb25maWcuY3VycmVudFZhbHVlWydyZWZyZXNoJ107XG4gICAgICAgIGNvbnN0IG5ld09wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBjb25maWcuY3VycmVudFZhbHVlKTtcbiAgICAgICAgZGVsZXRlIG5ld09wdGlvbnNbJ3JlZnJlc2gnXTtcblxuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuJGluc3RhbmNlLnNsaWNrKCdzbGlja1NldE9wdGlvbicsIG5ld09wdGlvbnMsIHJlZnJlc2gpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxufVxuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbbmd4U2xpY2tJdGVtXScsXG59KVxuZXhwb3J0IGNsYXNzIFNsaWNrSXRlbURpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgY29uc3RydWN0b3IocHVibGljIGVsOiBFbGVtZW50UmVmLFxuICAgICAgICAgICAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IHN0cmluZyxcbiAgICAgICAgICAgICAgQEhvc3QoKSBwcml2YXRlIGNhcm91c2VsOiBTbGlja0Nhcm91c2VsQ29tcG9uZW50KSB7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgdGhpcy5jYXJvdXNlbC5hZGRTbGlkZSh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgdGhpcy5jYXJvdXNlbC5yZW1vdmVTbGlkZSh0aGlzKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==